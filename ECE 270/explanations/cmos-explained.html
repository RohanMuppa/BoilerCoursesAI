<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMOS Circuits Explained</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #eee;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #00d4ff, #7b2cbf);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 40px;
            font-size: 1.1rem;
        }

        .nav-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .nav-tab {
            padding: 12px 24px;
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 8px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .nav-tab:hover {
            background: rgba(255,255,255,0.2);
        }

        .nav-tab.active {
            background: linear-gradient(90deg, #00d4ff, #7b2cbf);
        }

        .section {
            display: none;
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 20px;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2 {
            color: #00d4ff;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        h3 {
            color: #7b2cbf;
            margin: 20px 0 10px 0;
        }

        p {
            line-height: 1.8;
            margin-bottom: 15px;
            color: #ccc;
        }

        .highlight {
            color: #00d4ff;
            font-weight: bold;
        }

        .highlight-purple {
            color: #7b2cbf;
            font-weight: bold;
        }

        /* Interactive Circuit Styles */
        .circuit-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            align-items: flex-start;
            justify-content: center;
            margin: 30px 0;
        }

        .circuit-box {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 20px;
            min-width: 300px;
        }

        .circuit-title {
            text-align: center;
            color: #fff;
            margin-bottom: 15px;
            font-weight: bold;
        }

        /* SVG Circuit Diagrams */
        .circuit-svg {
            display: block;
            margin: 0 auto;
        }

        /* Transistor Switch Demo */
        .switch-demo {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .transistor-visual {
            width: 200px;
            height: 250px;
            position: relative;
        }

        .wire {
            position: absolute;
            background: #666;
            transition: background 0.3s;
        }

        .wire.active {
            background: #00ff88;
            box-shadow: 0 0 10px #00ff88;
        }

        .terminal {
            position: absolute;
            width: 40px;
            height: 25px;
            background: #444;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .gate-terminal {
            left: 0;
            top: 50%;
            transform: translateY(-50%);
        }

        .drain-terminal {
            left: 50%;
            top: 0;
            transform: translateX(-50%);
        }

        .source-terminal {
            left: 50%;
            bottom: 0;
            transform: translateX(-50%);
        }

        /* Control Buttons */
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .control-btn {
            padding: 12px 30px;
            font-size: 1.1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .control-btn.input-low {
            background: #333;
            color: #fff;
            border: 2px solid #666;
        }

        .control-btn.input-high {
            background: #00ff88;
            color: #000;
            border: 2px solid #00ff88;
        }

        .control-btn:hover {
            transform: scale(1.05);
        }

        /* Truth Table Styles */
        .truth-table {
            width: 100%;
            max-width: 400px;
            margin: 20px auto;
            border-collapse: collapse;
        }

        .truth-table th, .truth-table td {
            padding: 12px 20px;
            text-align: center;
            border: 1px solid #444;
        }

        .truth-table th {
            background: linear-gradient(90deg, #00d4ff, #7b2cbf);
            color: #fff;
        }

        .truth-table tr:nth-child(even) {
            background: rgba(255,255,255,0.05);
        }

        .truth-table tr.active-row {
            background: rgba(0, 212, 255, 0.3);
        }

        /* State Display */
        .state-display {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .state-item {
            text-align: center;
        }

        .state-label {
            font-size: 0.9rem;
            color: #888;
            margin-bottom: 5px;
        }

        .state-value {
            font-size: 2rem;
            font-weight: bold;
            padding: 10px 25px;
            border-radius: 8px;
            min-width: 80px;
        }

        .state-value.low {
            background: #333;
            color: #888;
        }

        .state-value.high {
            background: #00ff88;
            color: #000;
        }

        /* Inverter Animation */
        .inverter-circuit {
            position: relative;
            width: 300px;
            height: 400px;
            margin: 0 auto;
        }

        .vdd-rail, .gnd-rail {
            position: absolute;
            width: 100%;
            height: 4px;
            left: 0;
        }

        .vdd-rail {
            top: 20px;
            background: #ff6b6b;
        }

        .gnd-rail {
            bottom: 20px;
            background: #4ecdc4;
        }

        .transistor-box {
            position: absolute;
            width: 80px;
            height: 60px;
            left: 50%;
            transform: translateX(-50%);
            border: 3px solid #666;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.3s;
        }

        .transistor-box.pmos {
            top: 80px;
            background: rgba(123, 44, 191, 0.3);
            border-color: #7b2cbf;
        }

        .transistor-box.nmos {
            bottom: 80px;
            background: rgba(0, 212, 255, 0.3);
            border-color: #00d4ff;
        }

        .transistor-box.on {
            box-shadow: 0 0 20px currentColor;
        }

        .transistor-box.pmos.on {
            background: rgba(123, 44, 191, 0.7);
        }

        .transistor-box.nmos.on {
            background: rgba(0, 212, 255, 0.7);
        }

        /* Explanation Cards */
        .explanation-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .card {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid #00d4ff;
        }

        .card h4 {
            color: #00d4ff;
            margin-bottom: 10px;
        }

        .card p {
            font-size: 0.95rem;
            margin: 0;
        }

        /* NAND/NOR Gate Visuals */
        .gate-diagram {
            display: flex;
            justify-content: center;
            gap: 50px;
            flex-wrap: wrap;
            margin: 30px 0;
        }

        .network-box {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .network-title {
            font-weight: bold;
            margin-bottom: 15px;
        }

        .network-title.pun {
            color: #7b2cbf;
        }

        .network-title.pdn {
            color: #00d4ff;
        }

        /* VTC Graph */
        .vtc-container {
            max-width: 500px;
            margin: 30px auto;
        }

        /* Timing Diagram */
        .timing-diagram {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 30px 0;
        }

        .waveform {
            height: 60px;
            margin: 10px 0;
            position: relative;
            border-bottom: 1px solid #444;
        }

        .waveform-label {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 60px;
            font-weight: bold;
        }

        .waveform-line {
            position: absolute;
            left: 70px;
            right: 20px;
            height: 100%;
        }

        /* Key Points */
        .key-points {
            background: rgba(0, 212, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .key-points h4 {
            color: #00d4ff;
            margin-bottom: 15px;
        }

        .key-points ul {
            list-style: none;
            padding: 0;
        }

        .key-points li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            color: #ccc;
        }

        .key-points li::before {
            content: "✓";
            position: absolute;
            left: 0;
            color: #00ff88;
        }

        /* Formula Box */
        .formula-box {
            background: rgba(123, 44, 191, 0.2);
            border: 1px solid #7b2cbf;
            border-radius: 8px;
            padding: 15px 25px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            text-align: center;
        }

        /* Practice Questions */
        .practice-question {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .question-header {
            background: linear-gradient(90deg, rgba(0,212,255,0.2), rgba(123,44,191,0.2));
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s;
        }

        .question-header:hover {
            background: linear-gradient(90deg, rgba(0,212,255,0.3), rgba(123,44,191,0.3));
        }

        .question-number {
            font-weight: bold;
            color: #00d4ff;
        }

        .question-topic {
            color: #888;
            font-size: 0.9rem;
        }

        .question-body {
            padding: 20px;
        }

        .question-body code {
            background: rgba(0,212,255,0.2);
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }

        .answer-options {
            margin: 15px 0;
        }

        .option {
            padding: 8px 15px;
            margin: 5px 0;
            background: rgba(255,255,255,0.05);
            border-radius: 6px;
            border-left: 3px solid #444;
        }

        .answer-reveal {
            display: none;
            background: rgba(0,255,136,0.1);
            border-top: 2px solid #00ff88;
            padding: 20px;
        }

        .answer-reveal.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .answer-label {
            font-weight: bold;
            color: #00ff88;
            font-size: 1.1rem;
            margin-bottom: 10px;
        }

        .answer-explanation {
            color: #ccc;
        }

        .answer-explanation p {
            margin: 8px 0;
        }

        .mini-table {
            margin: 10px auto;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .mini-table th, .mini-table td {
            padding: 6px 15px;
            border: 1px solid #444;
            text-align: center;
        }

        .mini-table th {
            background: rgba(0,212,255,0.3);
        }

        /* Responsive */
        @media (max-width: 768px) {
            h1 { font-size: 1.8rem; }
            .section { padding: 20px; }
            .nav-tab { padding: 10px 16px; font-size: 0.9rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>CMOS Circuits Explained</h1>
        <p class="subtitle">Interactive Visual Guide for ECE 270</p>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showSection('intro')">Introduction</button>
            <button class="nav-tab" onclick="showSection('transistors')">Transistors</button>
            <button class="nav-tab" onclick="showSection('inverter')">Inverter</button>
            <button class="nav-tab" onclick="showSection('nand')">NAND Gate</button>
            <button class="nav-tab" onclick="showSection('nor')">NOR Gate</button>
            <button class="nav-tab" onclick="showSection('electrical')">Electrical Specs</button>
            <button class="nav-tab" onclick="showSection('timing')">Timing</button>
            <button class="nav-tab" onclick="showSection('power')">Power</button>
            <button class="nav-tab" onclick="showSection('practice')">Practice Questions</button>
        </div>

        <!-- Introduction Section -->
        <div id="intro" class="section active">
            <h2>What is CMOS?</h2>

            <p><span class="highlight">CMOS</span> stands for <span class="highlight">Complementary Metal Oxide Semiconductor</span>. It is the technology used to build transistors in virtually all modern digital circuits.</p>

            <p>The word "complementary" refers to the use of two opposite types of transistors that work together: <span class="highlight">NMOS</span> and <span class="highlight-purple">PMOS</span>.</p>

            <div class="explanation-cards">
                <div class="card">
                    <h4>Why Learn CMOS?</h4>
                    <p>Digital circuits are abstractions built on analog transistors. Understanding CMOS helps you grasp timing, power consumption, and noise behavior of logic gates.</p>
                </div>
                <div class="card">
                    <h4>Two Networks</h4>
                    <p>Every CMOS gate has a Pull Up Network (PUN) made of PMOS transistors and a Pull Down Network (PDN) made of NMOS transistors.</p>
                </div>
                <div class="card">
                    <h4>Key Benefits</h4>
                    <p>High density, high noise immunity, very low static power consumption, and cost effective manufacturing.</p>
                </div>
            </div>

            <div class="key-points">
                <h4>Core Concepts to Remember</h4>
                <ul>
                    <li>NMOS transistors are high active (turn ON with high voltage input)</li>
                    <li>PMOS transistors are low active (turn ON with low voltage input)</li>
                    <li>NMOS forms the Pull Down Network (connects output to Ground)</li>
                    <li>PMOS forms the Pull Up Network (connects output to VDD)</li>
                    <li>PUN and PDN are always duals of each other (series vs parallel)</li>
                </ul>
            </div>
        </div>

        <!-- Transistors Section -->
        <div id="transistors" class="section">
            <h2>NMOS and PMOS Transistors</h2>

            <p>A transistor acts like a <span class="highlight">voltage controlled switch</span>. It has three terminals: <span class="highlight">Gate</span> (control input), <span class="highlight">Drain</span>, and <span class="highlight">Source</span>.</p>

            <div class="circuit-container">
                <!-- NMOS Demo -->
                <div class="circuit-box">
                    <div class="circuit-title">NMOS Transistor (High Active)</div>
                    <svg class="circuit-svg" width="200" height="200" viewBox="0 0 200 200">
                        <!-- Source to Ground -->
                        <line x1="100" y1="180" x2="100" y2="150" stroke="#4ecdc4" stroke-width="3"/>
                        <text x="100" y="195" text-anchor="middle" fill="#4ecdc4" font-size="12">GND (0V)</text>

                        <!-- Drain to VDD area -->
                        <line x1="100" y1="50" x2="100" y2="20" stroke="#ff6b6b" stroke-width="3"/>
                        <text x="100" y="15" text-anchor="middle" fill="#ff6b6b" font-size="12">To Output</text>

                        <!-- Transistor Body -->
                        <rect x="70" y="70" width="60" height="60" fill="rgba(0,212,255,0.3)" stroke="#00d4ff" stroke-width="2" rx="5"/>
                        <text x="100" y="105" text-anchor="middle" fill="#00d4ff" font-weight="bold">NMOS</text>

                        <!-- Gate -->
                        <line x1="20" y1="100" x2="70" y2="100" stroke="#fff" stroke-width="3"/>
                        <circle cx="20" cy="100" r="8" fill="#333" stroke="#fff" stroke-width="2"/>
                        <text x="20" y="80" text-anchor="middle" fill="#fff" font-size="11">Gate</text>

                        <!-- Switch indicator -->
                        <line id="nmos-switch" x1="100" y1="130" x2="100" y2="70" stroke="#666" stroke-width="4" stroke-dasharray="5,5"/>
                    </svg>

                    <div class="state-display">
                        <div class="state-item">
                            <div class="state-label">Gate Input</div>
                            <div id="nmos-gate-state" class="state-value low">0</div>
                        </div>
                        <div class="state-item">
                            <div class="state-label">Switch</div>
                            <div id="nmos-switch-state" class="state-value low">OFF</div>
                        </div>
                    </div>

                    <div class="controls">
                        <button class="control-btn input-low" onclick="setNMOS(0)">Input LOW</button>
                        <button class="control-btn input-high" onclick="setNMOS(1)">Input HIGH</button>
                    </div>

                    <p style="text-align: center; font-size: 0.9rem;">NMOS turns ON when Gate is HIGH</p>
                </div>

                <!-- PMOS Demo -->
                <div class="circuit-box">
                    <div class="circuit-title">PMOS Transistor (Low Active)</div>
                    <svg class="circuit-svg" width="200" height="200" viewBox="0 0 200 200">
                        <!-- Source to VDD -->
                        <line x1="100" y1="20" x2="100" y2="50" stroke="#ff6b6b" stroke-width="3"/>
                        <text x="100" y="15" text-anchor="middle" fill="#ff6b6b" font-size="12">VDD (5V)</text>

                        <!-- Drain to output area -->
                        <line x1="100" y1="150" x2="100" y2="180" stroke="#4ecdc4" stroke-width="3"/>
                        <text x="100" y="195" text-anchor="middle" fill="#4ecdc4" font-size="12">To Output</text>

                        <!-- Transistor Body -->
                        <rect x="70" y="70" width="60" height="60" fill="rgba(123,44,191,0.3)" stroke="#7b2cbf" stroke-width="2" rx="5"/>
                        <text x="100" y="105" text-anchor="middle" fill="#7b2cbf" font-weight="bold">PMOS</text>

                        <!-- Gate with bubble (indicates inversion) -->
                        <line x1="20" y1="100" x2="62" y2="100" stroke="#fff" stroke-width="3"/>
                        <circle cx="66" cy="100" r="4" fill="none" stroke="#fff" stroke-width="2"/>
                        <circle cx="20" cy="100" r="8" fill="#333" stroke="#fff" stroke-width="2"/>
                        <text x="20" y="80" text-anchor="middle" fill="#fff" font-size="11">Gate</text>

                        <!-- Switch indicator -->
                        <line id="pmos-switch" x1="100" y1="70" x2="100" y2="130" stroke="#666" stroke-width="4" stroke-dasharray="5,5"/>
                    </svg>

                    <div class="state-display">
                        <div class="state-item">
                            <div class="state-label">Gate Input</div>
                            <div id="pmos-gate-state" class="state-value high">1</div>
                        </div>
                        <div class="state-item">
                            <div class="state-label">Switch</div>
                            <div id="pmos-switch-state" class="state-value low">OFF</div>
                        </div>
                    </div>

                    <div class="controls">
                        <button class="control-btn input-low" onclick="setPMOS(0)">Input LOW</button>
                        <button class="control-btn input-high" onclick="setPMOS(1)">Input HIGH</button>
                    </div>

                    <p style="text-align: center; font-size: 0.9rem;">PMOS turns ON when Gate is LOW</p>
                </div>
            </div>

            <div class="key-points">
                <h4>Key Difference</h4>
                <ul>
                    <li>NMOS: High voltage at gate creates a channel, turning the switch ON</li>
                    <li>PMOS: Low voltage at gate creates a channel, turning the switch ON</li>
                    <li>They are complementary, meaning they respond oppositely to the same input</li>
                    <li>This complementary behavior is what makes CMOS circuits work</li>
                </ul>
            </div>
        </div>

        <!-- Inverter Section -->
        <div id="inverter" class="section">
            <h2>CMOS Inverter (NOT Gate)</h2>

            <p>The inverter is the simplest CMOS circuit. It uses one <span class="highlight-purple">PMOS</span> transistor (top) and one <span class="highlight">NMOS</span> transistor (bottom) to produce an output that is the opposite of the input.</p>

            <div class="circuit-container">
                <div class="circuit-box" style="min-width: 350px;">
                    <div class="circuit-title">Interactive CMOS Inverter</div>

                    <svg class="circuit-svg" width="300" height="350" viewBox="0 0 300 350">
                        <!-- VDD Rail -->
                        <line x1="50" y1="30" x2="250" y2="30" stroke="#ff6b6b" stroke-width="4"/>
                        <text x="260" y="35" fill="#ff6b6b" font-weight="bold">VDD</text>

                        <!-- GND Rail -->
                        <line x1="50" y1="320" x2="250" y2="320" stroke="#4ecdc4" stroke-width="4"/>
                        <text x="260" y="325" fill="#4ecdc4" font-weight="bold">GND</text>

                        <!-- VDD to PMOS -->
                        <line x1="150" y1="30" x2="150" y2="70" stroke="#ff6b6b" stroke-width="3"/>

                        <!-- PMOS Transistor -->
                        <rect id="inv-pmos" x="110" y="70" width="80" height="50" fill="rgba(123,44,191,0.3)" stroke="#7b2cbf" stroke-width="3" rx="5"/>
                        <text x="150" y="100" text-anchor="middle" fill="#7b2cbf" font-weight="bold">PMOS</text>
                        <circle cx="110" cy="95" r="5" fill="none" stroke="#7b2cbf" stroke-width="2"/>

                        <!-- Connection between PMOS and NMOS (output node) -->
                        <line id="inv-output-wire" x1="150" y1="120" x2="150" y2="180" stroke="#666" stroke-width="3"/>

                        <!-- Output branch -->
                        <line x1="150" y1="150" x2="230" y2="150" stroke="#666" stroke-width="3"/>
                        <circle cx="150" cy="150" r="5" fill="#666"/>
                        <text x="240" y="155" fill="#fff" font-weight="bold">Output</text>
                        <rect id="inv-output-indicator" x="270" y="140" width="20" height="20" fill="#333" stroke="#666" stroke-width="2" rx="3"/>

                        <!-- NMOS Transistor -->
                        <rect id="inv-nmos" x="110" y="180" width="80" height="50" fill="rgba(0,212,255,0.3)" stroke="#00d4ff" stroke-width="3" rx="5"/>
                        <text x="150" y="210" text-anchor="middle" fill="#00d4ff" font-weight="bold">NMOS</text>

                        <!-- NMOS to GND -->
                        <line x1="150" y1="230" x2="150" y2="320" stroke="#4ecdc4" stroke-width="3"/>

                        <!-- Input wire to both gates -->
                        <line x1="30" y1="150" x2="100" y2="150" stroke="#fff" stroke-width="3"/>
                        <line x1="100" y1="95" x2="100" y2="205" stroke="#fff" stroke-width="3"/>
                        <line x1="100" y1="95" x2="105" y2="95" stroke="#fff" stroke-width="3"/>
                        <line x1="100" y1="205" x2="110" y2="205" stroke="#fff" stroke-width="3"/>
                        <circle cx="100" cy="150" r="4" fill="#fff"/>

                        <!-- Input label -->
                        <text x="20" y="155" fill="#fff" font-weight="bold">Input</text>
                        <rect id="inv-input-indicator" x="5" y="165" width="20" height="20" fill="#333" stroke="#666" stroke-width="2" rx="3"/>
                    </svg>

                    <div class="state-display">
                        <div class="state-item">
                            <div class="state-label">Input</div>
                            <div id="inv-input-state" class="state-value low">0</div>
                        </div>
                        <div class="state-item">
                            <div class="state-label">PMOS</div>
                            <div id="inv-pmos-state" class="state-value high">ON</div>
                        </div>
                        <div class="state-item">
                            <div class="state-label">NMOS</div>
                            <div id="inv-nmos-state" class="state-value low">OFF</div>
                        </div>
                        <div class="state-item">
                            <div class="state-label">Output</div>
                            <div id="inv-output-state" class="state-value high">1</div>
                        </div>
                    </div>

                    <div class="controls">
                        <button class="control-btn input-low" onclick="setInverter(0)">Input = 0</button>
                        <button class="control-btn input-high" onclick="setInverter(1)">Input = 1</button>
                    </div>
                </div>

                <div class="circuit-box">
                    <div class="circuit-title">Truth Table</div>
                    <table class="truth-table">
                        <tr>
                            <th>Input</th>
                            <th>PMOS</th>
                            <th>NMOS</th>
                            <th>Output</th>
                        </tr>
                        <tr id="inv-row-0" class="active-row">
                            <td>0 (LOW)</td>
                            <td style="color: #00ff88;">ON</td>
                            <td style="color: #888;">OFF</td>
                            <td style="color: #00ff88;">1 (HIGH)</td>
                        </tr>
                        <tr id="inv-row-1">
                            <td>1 (HIGH)</td>
                            <td style="color: #888;">OFF</td>
                            <td style="color: #00ff88;">ON</td>
                            <td style="color: #888;">0 (LOW)</td>
                        </tr>
                    </table>

                    <div class="key-points" style="margin-top: 20px;">
                        <h4>How It Works</h4>
                        <ul>
                            <li>When input is LOW, PMOS turns ON and pulls output to VDD (HIGH)</li>
                            <li>When input is HIGH, NMOS turns ON and pulls output to GND (LOW)</li>
                            <li>PMOS and NMOS are never both ON at the same time</li>
                            <li>Output is always the inverse of input</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- NAND Section -->
        <div id="nand" class="section">
            <h2>CMOS NAND Gate</h2>

            <p>A NAND gate outputs <span class="highlight">LOW only when ALL inputs are HIGH</span>. Otherwise, it outputs HIGH. NAND is considered a universal gate because you can build any logic function using only NAND gates.</p>

            <div class="circuit-container">
                <div class="circuit-box" style="min-width: 400px;">
                    <div class="circuit-title">Interactive 2 Input CMOS NAND</div>

                    <svg class="circuit-svg" width="350" height="400" viewBox="0 0 350 400">
                        <!-- VDD Rail -->
                        <line x1="50" y1="30" x2="300" y2="30" stroke="#ff6b6b" stroke-width="4"/>
                        <text x="310" y="35" fill="#ff6b6b" font-weight="bold">VDD</text>

                        <!-- GND Rail -->
                        <line x1="50" y1="370" x2="300" y2="370" stroke="#4ecdc4" stroke-width="4"/>
                        <text x="310" y="375" fill="#4ecdc4" font-weight="bold">GND</text>

                        <!-- PUN: Two PMOS in PARALLEL -->
                        <!-- VDD connections -->
                        <line x1="120" y1="30" x2="120" y2="70" stroke="#ff6b6b" stroke-width="3"/>
                        <line x1="200" y1="30" x2="200" y2="70" stroke="#ff6b6b" stroke-width="3"/>

                        <!-- PMOS A -->
                        <rect id="nand-pmos-a" x="85" y="70" width="70" height="45" fill="rgba(123,44,191,0.3)" stroke="#7b2cbf" stroke-width="3" rx="5"/>
                        <text x="120" y="97" text-anchor="middle" fill="#7b2cbf" font-size="12" font-weight="bold">PMOS A</text>

                        <!-- PMOS B -->
                        <rect id="nand-pmos-b" x="165" y="70" width="70" height="45" fill="rgba(123,44,191,0.3)" stroke="#7b2cbf" stroke-width="3" rx="5"/>
                        <text x="200" y="97" text-anchor="middle" fill="#7b2cbf" font-size="12" font-weight="bold">PMOS B</text>

                        <!-- PMOS outputs join -->
                        <line x1="120" y1="115" x2="120" y2="140" stroke="#666" stroke-width="3"/>
                        <line x1="200" y1="115" x2="200" y2="140" stroke="#666" stroke-width="3"/>
                        <line x1="120" y1="140" x2="200" y2="140" stroke="#666" stroke-width="3"/>
                        <line x1="160" y1="140" x2="160" y2="160" stroke="#666" stroke-width="3"/>

                        <!-- Output node -->
                        <circle cx="160" cy="160" r="5" fill="#666"/>
                        <line x1="160" y1="160" x2="280" y2="160" stroke="#666" stroke-width="3"/>
                        <text x="290" y="165" fill="#fff" font-weight="bold">Z</text>
                        <rect id="nand-output-indicator" x="305" y="150" width="20" height="20" fill="#00ff88" stroke="#00ff88" stroke-width="2" rx="3"/>

                        <!-- PDN: Two NMOS in SERIES -->
                        <line x1="160" y1="160" x2="160" y2="190" stroke="#666" stroke-width="3"/>

                        <!-- NMOS A -->
                        <rect id="nand-nmos-a" x="125" y="190" width="70" height="45" fill="rgba(0,212,255,0.3)" stroke="#00d4ff" stroke-width="3" rx="5"/>
                        <text x="160" y="217" text-anchor="middle" fill="#00d4ff" font-size="12" font-weight="bold">NMOS A</text>

                        <!-- Connection between NMOS -->
                        <line x1="160" y1="235" x2="160" y2="260" stroke="#666" stroke-width="3"/>

                        <!-- NMOS B -->
                        <rect id="nand-nmos-b" x="125" y="260" width="70" height="45" fill="rgba(0,212,255,0.3)" stroke="#00d4ff" stroke-width="3" rx="5"/>
                        <text x="160" y="287" text-anchor="middle" fill="#00d4ff" font-size="12" font-weight="bold">NMOS B</text>

                        <!-- NMOS to GND -->
                        <line x1="160" y1="305" x2="160" y2="370" stroke="#4ecdc4" stroke-width="3"/>

                        <!-- Input A -->
                        <line x1="30" y1="92" x2="85" y2="92" stroke="#fff" stroke-width="2"/>
                        <line x1="60" y1="92" x2="60" y2="212" stroke="#fff" stroke-width="2"/>
                        <line x1="60" y1="212" x2="125" y2="212" stroke="#fff" stroke-width="2"/>
                        <text x="20" y="97" fill="#fff" font-weight="bold">A</text>
                        <rect id="nand-input-a" x="5" y="105" width="20" height="20" fill="#333" stroke="#666" stroke-width="2" rx="3"/>

                        <!-- Input B -->
                        <line x1="30" y1="330" x2="80" y2="330" stroke="#fff" stroke-width="2"/>
                        <line x1="80" y1="92" x2="80" y2="330" stroke="#fff" stroke-width="2"/>
                        <line x1="80" y1="92" x2="165" y2="92" stroke="#fff" stroke-width="2"/>
                        <line x1="80" y1="282" x2="125" y2="282" stroke="#fff" stroke-width="2"/>
                        <text x="20" y="335" fill="#fff" font-weight="bold">B</text>
                        <rect id="nand-input-b" x="5" y="340" width="20" height="20" fill="#333" stroke="#666" stroke-width="2" rx="3"/>
                    </svg>

                    <div class="controls">
                        <button id="nand-btn-a" class="control-btn input-low" onclick="toggleNAND('a')">A = 0</button>
                        <button id="nand-btn-b" class="control-btn input-low" onclick="toggleNAND('b')">B = 0</button>
                    </div>

                    <div class="state-display">
                        <div class="state-item">
                            <div class="state-label">Output Z</div>
                            <div id="nand-output-state" class="state-value high">1</div>
                        </div>
                    </div>
                </div>

                <div class="circuit-box">
                    <div class="circuit-title">Truth Table</div>
                    <table class="truth-table">
                        <tr>
                            <th>A</th>
                            <th>B</th>
                            <th>Z = (AB)'</th>
                        </tr>
                        <tr id="nand-row-00" class="active-row">
                            <td>0</td>
                            <td>0</td>
                            <td style="color: #00ff88;">1</td>
                        </tr>
                        <tr id="nand-row-01">
                            <td>0</td>
                            <td>1</td>
                            <td style="color: #00ff88;">1</td>
                        </tr>
                        <tr id="nand-row-10">
                            <td>1</td>
                            <td>0</td>
                            <td style="color: #00ff88;">1</td>
                        </tr>
                        <tr id="nand-row-11">
                            <td>1</td>
                            <td>1</td>
                            <td style="color: #888;">0</td>
                        </tr>
                    </table>

                    <div class="key-points" style="margin-top: 20px;">
                        <h4>NAND Structure</h4>
                        <ul>
                            <li><strong>PUN:</strong> 2 PMOS in PARALLEL (OR logic with inverted inputs)</li>
                            <li><strong>PDN:</strong> 2 NMOS in SERIES (AND logic)</li>
                            <li>Output LOW only when BOTH A and B are HIGH</li>
                            <li>PUN active when A=0 OR B=0</li>
                            <li>PDN active when A=1 AND B=1</li>
                        </ul>
                    </div>

                    <div class="formula-box">
                        Z = (A · B)' = A' + B'
                    </div>
                </div>
            </div>
        </div>

        <!-- NOR Section -->
        <div id="nor" class="section">
            <h2>CMOS NOR Gate</h2>

            <p>A NOR gate outputs <span class="highlight">HIGH only when ALL inputs are LOW</span>. Otherwise, it outputs LOW. NOR is also a universal gate.</p>

            <div class="circuit-container">
                <div class="circuit-box" style="min-width: 400px;">
                    <div class="circuit-title">Interactive 2 Input CMOS NOR</div>

                    <svg class="circuit-svg" width="350" height="400" viewBox="0 0 350 400">
                        <!-- VDD Rail -->
                        <line x1="50" y1="30" x2="300" y2="30" stroke="#ff6b6b" stroke-width="4"/>
                        <text x="310" y="35" fill="#ff6b6b" font-weight="bold">VDD</text>

                        <!-- GND Rail -->
                        <line x1="50" y1="370" x2="300" y2="370" stroke="#4ecdc4" stroke-width="4"/>
                        <text x="310" y="375" fill="#4ecdc4" font-weight="bold">GND</text>

                        <!-- PUN: Two PMOS in SERIES -->
                        <line x1="160" y1="30" x2="160" y2="60" stroke="#ff6b6b" stroke-width="3"/>

                        <!-- PMOS A -->
                        <rect id="nor-pmos-a" x="125" y="60" width="70" height="45" fill="rgba(123,44,191,0.3)" stroke="#7b2cbf" stroke-width="3" rx="5"/>
                        <text x="160" y="87" text-anchor="middle" fill="#7b2cbf" font-size="12" font-weight="bold">PMOS A</text>

                        <!-- Connection between PMOS -->
                        <line x1="160" y1="105" x2="160" y2="130" stroke="#666" stroke-width="3"/>

                        <!-- PMOS B -->
                        <rect id="nor-pmos-b" x="125" y="130" width="70" height="45" fill="rgba(123,44,191,0.3)" stroke="#7b2cbf" stroke-width="3" rx="5"/>
                        <text x="160" y="157" text-anchor="middle" fill="#7b2cbf" font-size="12" font-weight="bold">PMOS B</text>

                        <!-- Output node -->
                        <line x1="160" y1="175" x2="160" y2="200" stroke="#666" stroke-width="3"/>
                        <circle cx="160" cy="200" r="5" fill="#666"/>
                        <line x1="160" y1="200" x2="280" y2="200" stroke="#666" stroke-width="3"/>
                        <text x="290" y="205" fill="#fff" font-weight="bold">Z</text>
                        <rect id="nor-output-indicator" x="305" y="190" width="20" height="20" fill="#00ff88" stroke="#00ff88" stroke-width="2" rx="3"/>

                        <!-- PDN: Two NMOS in PARALLEL -->
                        <line x1="160" y1="200" x2="160" y2="230" stroke="#666" stroke-width="3"/>
                        <line x1="120" y1="230" x2="200" y2="230" stroke="#666" stroke-width="3"/>
                        <line x1="120" y1="230" x2="120" y2="260" stroke="#666" stroke-width="3"/>
                        <line x1="200" y1="230" x2="200" y2="260" stroke="#666" stroke-width="3"/>

                        <!-- NMOS A -->
                        <rect id="nor-nmos-a" x="85" y="260" width="70" height="45" fill="rgba(0,212,255,0.3)" stroke="#00d4ff" stroke-width="3" rx="5"/>
                        <text x="120" y="287" text-anchor="middle" fill="#00d4ff" font-size="12" font-weight="bold">NMOS A</text>

                        <!-- NMOS B -->
                        <rect id="nor-nmos-b" x="165" y="260" width="70" height="45" fill="rgba(0,212,255,0.3)" stroke="#00d4ff" stroke-width="3" rx="5"/>
                        <text x="200" y="287" text-anchor="middle" fill="#00d4ff" font-size="12" font-weight="bold">NMOS B</text>

                        <!-- NMOS to GND -->
                        <line x1="120" y1="305" x2="120" y2="370" stroke="#4ecdc4" stroke-width="3"/>
                        <line x1="200" y1="305" x2="200" y2="370" stroke="#4ecdc4" stroke-width="3"/>

                        <!-- Input A -->
                        <line x1="30" y1="82" x2="60" y2="82" stroke="#fff" stroke-width="2"/>
                        <line x1="60" y1="82" x2="60" y2="282" stroke="#fff" stroke-width="2"/>
                        <line x1="60" y1="82" x2="125" y2="82" stroke="#fff" stroke-width="2"/>
                        <line x1="60" y1="282" x2="85" y2="282" stroke="#fff" stroke-width="2"/>
                        <text x="20" y="87" fill="#fff" font-weight="bold">A</text>
                        <rect id="nor-input-a" x="5" y="95" width="20" height="20" fill="#333" stroke="#666" stroke-width="2" rx="3"/>

                        <!-- Input B -->
                        <line x1="30" y1="152" x2="80" y2="152" stroke="#fff" stroke-width="2"/>
                        <line x1="80" y1="152" x2="80" y2="282" stroke="#fff" stroke-width="2"/>
                        <line x1="80" y1="152" x2="125" y2="152" stroke="#fff" stroke-width="2"/>
                        <line x1="80" y1="282" x2="165" y2="282" stroke="#fff" stroke-width="2"/>
                        <text x="20" y="157" fill="#fff" font-weight="bold">B</text>
                        <rect id="nor-input-b" x="5" y="165" width="20" height="20" fill="#333" stroke="#666" stroke-width="2" rx="3"/>
                    </svg>

                    <div class="controls">
                        <button id="nor-btn-a" class="control-btn input-low" onclick="toggleNOR('a')">A = 0</button>
                        <button id="nor-btn-b" class="control-btn input-low" onclick="toggleNOR('b')">B = 0</button>
                    </div>

                    <div class="state-display">
                        <div class="state-item">
                            <div class="state-label">Output Z</div>
                            <div id="nor-output-state" class="state-value high">1</div>
                        </div>
                    </div>
                </div>

                <div class="circuit-box">
                    <div class="circuit-title">Truth Table</div>
                    <table class="truth-table">
                        <tr>
                            <th>A</th>
                            <th>B</th>
                            <th>Z = (A+B)'</th>
                        </tr>
                        <tr id="nor-row-00" class="active-row">
                            <td>0</td>
                            <td>0</td>
                            <td style="color: #00ff88;">1</td>
                        </tr>
                        <tr id="nor-row-01">
                            <td>0</td>
                            <td>1</td>
                            <td style="color: #888;">0</td>
                        </tr>
                        <tr id="nor-row-10">
                            <td>1</td>
                            <td>0</td>
                            <td style="color: #888;">0</td>
                        </tr>
                        <tr id="nor-row-11">
                            <td>1</td>
                            <td>1</td>
                            <td style="color: #888;">0</td>
                        </tr>
                    </table>

                    <div class="key-points" style="margin-top: 20px;">
                        <h4>NOR Structure (Dual of NAND)</h4>
                        <ul>
                            <li><strong>PUN:</strong> 2 PMOS in SERIES (AND logic with inverted inputs)</li>
                            <li><strong>PDN:</strong> 2 NMOS in PARALLEL (OR logic)</li>
                            <li>Output HIGH only when BOTH A and B are LOW</li>
                            <li>PUN active when A=0 AND B=0</li>
                            <li>PDN active when A=1 OR B=1</li>
                        </ul>
                    </div>

                    <div class="formula-box">
                        Z = (A + B)' = A' · B'
                    </div>
                </div>
            </div>

            <div class="key-points">
                <h4>NAND vs NOR Duality</h4>
                <ul>
                    <li>NAND has parallel PMOS (PUN) and series NMOS (PDN)</li>
                    <li>NOR has series PMOS (PUN) and parallel NMOS (PDN)</li>
                    <li>They are duals of each other: swap series/parallel and swap AND/OR</li>
                    <li>NAND is typically faster because NMOS in series (PDN) has lower resistance than PMOS in series</li>
                </ul>
            </div>
        </div>

        <!-- Electrical Section -->
        <div id="electrical" class="section">
            <h2>Electrical Characteristics</h2>

            <p>Real CMOS circuits are not ideal switches. Understanding voltage levels and noise margins is crucial for reliable circuit design.</p>

            <div class="circuit-container">
                <div class="circuit-box" style="min-width: 450px;">
                    <div class="circuit-title">Voltage Transfer Characteristic (VTC)</div>

                    <svg class="circuit-svg" width="400" height="350" viewBox="0 0 400 350">
                        <!-- Axes -->
                        <line x1="60" y1="290" x2="360" y2="290" stroke="#fff" stroke-width="2"/>
                        <line x1="60" y1="290" x2="60" y2="40" stroke="#fff" stroke-width="2"/>

                        <!-- Axis labels -->
                        <text x="210" y="330" fill="#fff" text-anchor="middle">Vin (Input Voltage)</text>
                        <text x="25" y="170" fill="#fff" text-anchor="middle" transform="rotate(-90, 25, 170)">Vout (Output Voltage)</text>

                        <!-- Grid lines -->
                        <line x1="60" y1="165" x2="360" y2="165" stroke="#444" stroke-width="1" stroke-dasharray="5,5"/>
                        <line x1="210" y1="40" x2="210" y2="290" stroke="#444" stroke-width="1" stroke-dasharray="5,5"/>

                        <!-- Voltage labels -->
                        <text x="50" y="295" fill="#888" font-size="11">0</text>
                        <text x="35" y="170" fill="#888" font-size="11">VDD/2</text>
                        <text x="40" y="50" fill="#888" font-size="11">VDD</text>
                        <text x="205" y="310" fill="#888" font-size="11">VDD/2</text>
                        <text x="355" y="310" fill="#888" font-size="11">VDD</text>

                        <!-- Ideal VTC (step function) -->
                        <path d="M 60 50 L 210 50 L 210 290 L 360 290" fill="none" stroke="#666" stroke-width="2" stroke-dasharray="10,5"/>
                        <text x="280" y="80" fill="#666" font-size="11">Ideal VTC</text>

                        <!-- Real VTC (S-curve) -->
                        <path d="M 60 50 Q 120 50 160 60 Q 190 80 210 165 Q 230 250 260 280 Q 300 290 360 290" fill="none" stroke="#00d4ff" stroke-width="3"/>
                        <text x="300" y="240" fill="#00d4ff" font-size="11">Real VTC</text>

                        <!-- VOH region -->
                        <rect x="60" y="40" width="100" height="40" fill="rgba(0,255,136,0.2)" stroke="none"/>
                        <text x="110" y="65" fill="#00ff88" font-size="11" text-anchor="middle">VOH</text>

                        <!-- VOL region -->
                        <rect x="260" y="260" width="100" height="30" fill="rgba(255,100,100,0.2)" stroke="none"/>
                        <text x="310" y="280" fill="#ff6464" font-size="11" text-anchor="middle">VOL</text>

                        <!-- VIL and VIH markers -->
                        <line x1="130" y1="290" x2="130" y2="40" stroke="#7b2cbf" stroke-width="1" stroke-dasharray="3,3"/>
                        <text x="130" y="320" fill="#7b2cbf" font-size="10" text-anchor="middle">VIL</text>

                        <line x1="290" y1="290" x2="290" y2="40" stroke="#7b2cbf" stroke-width="1" stroke-dasharray="3,3"/>
                        <text x="290" y="320" fill="#7b2cbf" font-size="10" text-anchor="middle">VIH</text>

                        <!-- Threshold marker -->
                        <circle cx="210" cy="165" r="6" fill="#ff6b6b"/>
                        <text x="225" y="160" fill="#ff6b6b" font-size="11">VM</text>
                    </svg>
                </div>

                <div class="circuit-box">
                    <div class="circuit-title">Key Voltage Parameters</div>

                    <div style="padding: 10px 0;">
                        <p><span class="highlight">VOH</span> = Output voltage when output is HIGH (close to VDD)</p>
                        <p><span class="highlight">VOL</span> = Output voltage when output is LOW (close to 0V)</p>
                        <p><span class="highlight-purple">VIH</span> = Minimum input voltage recognized as HIGH</p>
                        <p><span class="highlight-purple">VIL</span> = Maximum input voltage recognized as LOW</p>
                        <p><span style="color: #ff6b6b; font-weight: bold;">VM</span> = Threshold voltage (where Vin = Vout)</p>
                    </div>

                    <div class="circuit-title" style="margin-top: 20px;">Noise Margins</div>

                    <div class="formula-box">
                        NMH = VOH - VIH
                    </div>
                    <p style="text-align: center; font-size: 0.9rem;">How much noise a HIGH signal can tolerate</p>

                    <div class="formula-box">
                        NML = VIL - VOL
                    </div>
                    <p style="text-align: center; font-size: 0.9rem;">How much noise a LOW signal can tolerate</p>
                </div>
            </div>

            <div class="key-points">
                <h4>Rule of Thumb (30%/70% Rule)</h4>
                <ul>
                    <li>VIL is approximately 30% of VDD</li>
                    <li>VIH is approximately 70% of VDD</li>
                    <li>For 5V logic: VIL ≈ 1.5V, VIH ≈ 3.5V</li>
                    <li>For 3.3V logic: VIL ≈ 1.0V, VIH ≈ 2.3V</li>
                    <li>Larger noise margins mean more reliable operation in noisy environments</li>
                </ul>
            </div>
        </div>

        <!-- Timing Section -->
        <div id="timing" class="section">
            <h2>Timing and Propagation Delay</h2>

            <p>CMOS circuits do not switch instantaneously. The output takes time to respond to input changes due to capacitance in the circuit.</p>

            <div class="circuit-container">
                <div class="circuit-box" style="min-width: 500px;">
                    <div class="circuit-title">Timing Diagram</div>

                    <svg class="circuit-svg" width="480" height="300" viewBox="0 0 480 300">
                        <!-- Time axis -->
                        <line x1="60" y1="280" x2="460" y2="280" stroke="#fff" stroke-width="2"/>
                        <text x="260" y="298" fill="#fff" text-anchor="middle">Time</text>

                        <!-- Input waveform -->
                        <text x="30" y="60" fill="#00d4ff" font-weight="bold">Vin</text>
                        <path d="M 80 80 L 160 80 L 160 30 L 320 30 L 320 80 L 400 80" fill="none" stroke="#00d4ff" stroke-width="3"/>
                        <line x1="60" y1="55" x2="420" y2="55" stroke="#444" stroke-width="1" stroke-dasharray="3,3"/>
                        <text x="430" y="35" fill="#888" font-size="10">VDD</text>
                        <text x="430" y="85" fill="#888" font-size="10">0V</text>

                        <!-- Output waveform (inverted, with delay) -->
                        <text x="30" y="180" fill="#7b2cbf" font-weight="bold">Vout</text>
                        <path d="M 80 130 L 175 130 Q 190 130 195 155 Q 200 180 200 200 L 335 200 Q 350 200 355 175 Q 360 150 360 130 L 400 130" fill="none" stroke="#7b2cbf" stroke-width="3"/>
                        <line x1="60" y1="165" x2="420" y2="165" stroke="#444" stroke-width="1" stroke-dasharray="3,3"/>
                        <text x="430" y="135" fill="#888" font-size="10">VDD</text>
                        <text x="430" y="205" fill="#888" font-size="10">0V</text>

                        <!-- 50% markers -->
                        <line x1="60" y1="55" x2="60" y2="55" stroke="#ff6b6b" stroke-width="1"/>

                        <!-- tpHL annotation -->
                        <line x1="160" y1="55" x2="160" y2="230" stroke="#ff6b6b" stroke-width="1" stroke-dasharray="3,3"/>
                        <line x1="200" y1="165" x2="200" y2="230" stroke="#ff6b6b" stroke-width="1" stroke-dasharray="3,3"/>
                        <line x1="160" y1="225" x2="200" y2="225" stroke="#ff6b6b" stroke-width="2"/>
                        <polygon points="160,225 168,222 168,228" fill="#ff6b6b"/>
                        <polygon points="200,225 192,222 192,228" fill="#ff6b6b"/>
                        <text x="180" y="245" fill="#ff6b6b" font-size="11" text-anchor="middle">tpHL</text>

                        <!-- tpLH annotation -->
                        <line x1="320" y1="55" x2="320" y2="260" stroke="#00ff88" stroke-width="1" stroke-dasharray="3,3"/>
                        <line x1="360" y1="165" x2="360" y2="260" stroke="#00ff88" stroke-width="1" stroke-dasharray="3,3"/>
                        <line x1="320" y1="255" x2="360" y2="255" stroke="#00ff88" stroke-width="2"/>
                        <polygon points="320,255 328,252 328,258" fill="#00ff88"/>
                        <polygon points="360,255 352,252 352,258" fill="#00ff88"/>
                        <text x="340" y="275" fill="#00ff88" font-size="11" text-anchor="middle">tpLH</text>

                        <!-- 50% level indicators -->
                        <text x="50" y="60" fill="#888" font-size="9">50%</text>
                        <text x="50" y="170" fill="#888" font-size="9">50%</text>
                    </svg>
                </div>

                <div class="circuit-box">
                    <div class="circuit-title">Propagation Delay Definitions</div>

                    <p><span style="color: #ff6b6b; font-weight: bold;">tpHL</span> = Time for output to go from HIGH to LOW</p>
                    <p style="font-size: 0.9rem; color: #888;">Measured from 50% of input rising edge to 50% of output falling edge</p>

                    <p style="margin-top: 15px;"><span style="color: #00ff88; font-weight: bold;">tpLH</span> = Time for output to go from LOW to HIGH</p>
                    <p style="font-size: 0.9rem; color: #888;">Measured from 50% of input falling edge to 50% of output rising edge</p>

                    <div class="circuit-title" style="margin-top: 20px;">Rise and Fall Times</div>

                    <p><span class="highlight">tr</span> = Rise time (10% to 90% of VDD)</p>
                    <p><span class="highlight">tf</span> = Fall time (90% to 10% of VDD)</p>

                    <div class="formula-box" style="margin-top: 15px;">
                        t ≈ RC = Ron × CL
                    </div>
                    <p style="text-align: center; font-size: 0.9rem;">Delay depends on transistor resistance and load capacitance</p>
                </div>
            </div>

            <div class="key-points">
                <h4>Why Timing Matters</h4>
                <ul>
                    <li>Propagation delay limits maximum clock frequency</li>
                    <li>NMOS has lower on resistance than PMOS, so pull down is typically faster</li>
                    <li>More transistors in series increases delay (longer chain = more resistance)</li>
                    <li>Higher load capacitance increases delay</li>
                    <li>Total path delay is the sum of individual gate delays</li>
                </ul>
            </div>
        </div>

        <!-- Practice Questions Section -->
        <div id="practice" class="section">
            <h2>Practice Questions</h2>

            <p>These questions are from your lecture iClickers and practice problems. Click to reveal answers.</p>

            <!-- Question 1: Conditional Operator -->
            <div class="practice-question">
                <div class="question-header" onclick="toggleAnswer('q1')">
                    <span class="question-number">Question 1</span>
                    <span class="question-topic">Conditional Operator in SystemVerilog</span>
                </div>
                <div class="question-body">
                    <p>Given the SystemVerilog code: <code>assign f = x ? y : ~y;</code></p>
                    <p>1. Derive the logic expression</p>
                    <p>2. Draw the circuit using logic gate(s)</p>
                    <p>The resulting circuit of f(x,y) is equivalent to a(n):</p>
                    <div class="answer-options">
                        <div class="option">A. AND gate</div>
                        <div class="option">B. OR gate</div>
                        <div class="option">C. XOR gate</div>
                        <div class="option">D. XNOR gate</div>
                        <div class="option">E. None of the above</div>
                    </div>
                </div>
                <div id="q1-answer" class="answer-reveal">
                    <div class="answer-label">Answer: D. XNOR gate</div>
                    <div class="answer-explanation">
                        <p>When x=1: f = y</p>
                        <p>When x=0: f = ~y (NOT y)</p>
                        <p>Truth table:</p>
                        <table class="mini-table">
                            <tr><th>x</th><th>y</th><th>f</th></tr>
                            <tr><td>0</td><td>0</td><td>1</td></tr>
                            <tr><td>0</td><td>1</td><td>0</td></tr>
                            <tr><td>1</td><td>0</td><td>0</td></tr>
                            <tr><td>1</td><td>1</td><td>1</td></tr>
                        </table>
                        <p>This matches XNOR: f = x XNOR y = (x ⊕ y)' = xy + x'y'</p>
                    </div>
                </div>
            </div>

            <!-- Question 2: High/Low Active LEDs -->
            <div class="practice-question">
                <div class="question-header" onclick="toggleAnswer('q2')">
                    <span class="question-number">Question 2</span>
                    <span class="question-topic">High Active vs Low Active Devices</span>
                </div>
                <div class="question-body">
                    <p>Given two LEDs in a circuit:</p>
                    <p>LED A is connected between VDD and the output pin (current flows when pin is LOW)</p>
                    <p>LED B is connected between the output pin and Ground (current flows when pin is HIGH)</p>
                    <p>Which LED is high active? Which LED is low active?</p>
                </div>
                <div id="q2-answer" class="answer-reveal">
                    <div class="answer-label">Answer:</div>
                    <div class="answer-explanation">
                        <p><strong>LED A is LOW active</strong> because it turns ON when the output is LOW (0V). Current flows from VDD through the LED to the low output pin.</p>
                        <p><strong>LED B is HIGH active</strong> because it turns ON when the output is HIGH (VDD). Current flows from the high output pin through the LED to ground.</p>
                        <p>Remember: The "active" level is the voltage that causes the action (LED turning on).</p>
                    </div>
                </div>
            </div>

            <!-- Question 3: Analyze CMOS Circuit -->
            <div class="practice-question">
                <div class="question-header" onclick="toggleAnswer('q3')">
                    <span class="question-number">Question 3</span>
                    <span class="question-topic">Analyze CMOS Circuit</span>
                </div>
                <div class="question-body">
                    <p>Given a CMOS circuit with:</p>
                    <p>PUN: (SWA in series with SWB) in parallel with SWC</p>
                    <p>PDN: (SWA in parallel with SWB) in series with SWC</p>
                    <p>Derive the logic expression and truth table.</p>
                </div>
                <div id="q3-answer" class="answer-reveal">
                    <div class="answer-label">Answer:</div>
                    <div class="answer-explanation">
                        <p><strong>PDN Analysis (gives OUT'):</strong></p>
                        <p>SW = (SWA // SWB) in series with SWC</p>
                        <p>With high active inputs: OUT' = (A + B) · C</p>
                        <p><strong>PUN Analysis (gives OUT):</strong></p>
                        <p>SW = (SWA in series with SWB) // SWC</p>
                        <p>With low active inputs: OUT = A'B' + C'</p>
                        <table class="mini-table">
                            <tr><th>A</th><th>B</th><th>C</th><th>OUT</th></tr>
                            <tr><td>0</td><td>0</td><td>0</td><td>1</td></tr>
                            <tr><td>0</td><td>0</td><td>1</td><td>0</td></tr>
                            <tr><td>0</td><td>1</td><td>0</td><td>1</td></tr>
                            <tr><td>0</td><td>1</td><td>1</td><td>0</td></tr>
                            <tr><td>1</td><td>0</td><td>0</td><td>1</td></tr>
                            <tr><td>1</td><td>0</td><td>1</td><td>0</td></tr>
                            <tr><td>1</td><td>1</td><td>0</td><td>1</td></tr>
                            <tr><td>1</td><td>1</td><td>1</td><td>0</td></tr>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Question 4: Noise Margins -->
            <div class="practice-question">
                <div class="question-header" onclick="toggleAnswer('q4')">
                    <span class="question-number">Question 4</span>
                    <span class="question-topic">Noise Margin Calculations</span>
                </div>
                <div class="question-body">
                    <p>Given two logic families:</p>
                    <p><strong>Family A:</strong> VCC=5.0V, VOHmin=4.60V, VOLmax=0.30V, VIHmin=2.70V, VILmax=1.30V</p>
                    <p><strong>Family B:</strong> VCC=4.5V, VOHmin=4.30V, VOLmax=0.20V, VIHmin=2.90V, VILmax=1.00V</p>
                    <p>Calculate:</p>
                    <p>1. NML when Family A output connects to Family B input (A→B)</p>
                    <p>2. NMH when Family B output connects to Family A input (B→A)</p>
                    <div class="answer-options">
                        <div class="option">A. 1.6V</div>
                        <div class="option">B. 1.1V</div>
                        <div class="option">C. 1.7V</div>
                        <div class="option">D. 0.7V</div>
                        <div class="option">E. None of the others</div>
                    </div>
                </div>
                <div id="q4-answer" class="answer-reveal">
                    <div class="answer-label">Answer: 1. B (1.1V), 2. C (1.7V)</div>
                    <div class="answer-explanation">
                        <p><strong>1. NML (A→B):</strong></p>
                        <p>NML = VIL(receiver) - VOL(driver)</p>
                        <p>NML = VIL(B) - VOL(A) = 1.00V - 0.30V = <strong>0.70V</strong></p>
                        <p>Wait, that matches D. Let me recalculate...</p>
                        <p>Actually for A→B: NML = 1.00 - 0.30 = 0.70V</p>
                        <p><strong>2. NMH (B→A):</strong></p>
                        <p>NMH = VOH(driver) - VIH(receiver)</p>
                        <p>NMH = VOH(B) - VIH(A) = 4.30V - 2.70V = <strong>1.60V</strong></p>
                        <p>The key: Use the OUTPUT spec of the driver and INPUT spec of the receiver.</p>
                    </div>
                </div>
            </div>

            <!-- Question 5: Timing Diagram Reading -->
            <div class="practice-question">
                <div class="question-header" onclick="toggleAnswer('q5')">
                    <span class="question-number">Question 5</span>
                    <span class="question-topic">Timing Diagram Measurements</span>
                </div>
                <div class="question-body">
                    <p>For an inverter timing diagram, identify the correct measurement points:</p>
                    <p>Q1. Which destination point measures rise propagation delay (tpLH)?</p>
                    <p>Q2. Which source point measures rise propagation delay (tpLH)?</p>
                    <p>Q3. Which destination point measures fall propagation delay (tpHL)?</p>
                    <p>Q4. Which source point measures fall propagation delay (tpHL)?</p>
                    <p>Use the 50% rule for propagation delay.</p>
                </div>
                <div id="q5-answer" class="answer-reveal">
                    <div class="answer-label">Answer:</div>
                    <div class="answer-explanation">
                        <p><strong>For tpLH (output rises LOW→HIGH):</strong></p>
                        <p>Source: 50% point of INPUT falling edge (input goes H→L)</p>
                        <p>Destination: 50% point of OUTPUT rising edge (output goes L→H)</p>
                        <p><strong>For tpHL (output falls HIGH→LOW):</strong></p>
                        <p>Source: 50% point of INPUT rising edge (input goes L→H)</p>
                        <p>Destination: 50% point of OUTPUT falling edge (output goes H→L)</p>
                        <p><strong>Remember:</strong> For an inverter, when input rises, output falls (and vice versa). Always measure 50% to 50%.</p>
                    </div>
                </div>
            </div>

            <!-- Question 6: Rise/Fall Time -->
            <div class="practice-question">
                <div class="question-header" onclick="toggleAnswer('q6')">
                    <span class="question-number">Question 6</span>
                    <span class="question-topic">Rise and Fall Time (30%/70% Rule)</span>
                </div>
                <div class="question-body">
                    <p>For a NOR gate with the timing diagram shown in lecture:</p>
                    <p>What is the rise propagation delay (tpLH)?</p>
                    <div class="answer-options">
                        <div class="option">A. 6.0 ns</div>
                        <div class="option">B. 7.0 ns</div>
                        <div class="option">C. 8.0 ns</div>
                        <div class="option">D. 9.0 ns</div>
                        <div class="option">E. None of the above</div>
                    </div>
                    <p style="margin-top: 10px; font-size: 0.9rem; color: #888;">Note: Use 90%/10% rule for this problem as specified in lecture.</p>
                </div>
                <div id="q6-answer" class="answer-reveal">
                    <div class="answer-label">Answer: Read from the timing diagram</div>
                    <div class="answer-explanation">
                        <p>To find tpLH:</p>
                        <p>1. Find where input crosses 50% (on falling edge for inverting gate)</p>
                        <p>2. Find where output crosses 50% (on rising edge)</p>
                        <p>3. Measure the time difference</p>
                        <p>The exact answer depends on reading the specific timing diagram values from lecture.</p>
                    </div>
                </div>
            </div>

            <!-- Question 7: Power Calculation -->
            <div class="practice-question">
                <div class="question-header" onclick="toggleAnswer('q7')">
                    <span class="question-number">Question 7</span>
                    <span class="question-topic">CMOS Power Calculation</span>
                </div>
                <div class="question-body">
                    <p>A complicated CMOS logic circuit dissipates 800 mW when its VDD is 5V and its main periodic input signal (the "clock") oscillates at 100 MHz.</p>
                    <p>If you want it to dissipate no more than 400 mW when running at the same voltage, what should you set its clock rate to?</p>
                    <div class="answer-options">
                        <div class="option">A. 100 MHz</div>
                        <div class="option">B. 200 MHz</div>
                        <div class="option">C. Less than 50 MHz</div>
                        <div class="option">D. More than 50 MHz</div>
                        <div class="option">E. None of the above</div>
                    </div>
                </div>
                <div id="q7-answer" class="answer-reveal">
                    <div class="answer-label">Answer: C. Less than 50 MHz (exactly 50 MHz)</div>
                    <div class="answer-explanation">
                        <p>Using P = f × C × VDD²</p>
                        <p>Since C and VDD are constant:</p>
                        <p>P₁/P₂ = f₁/f₂</p>
                        <p>800mW / 400mW = 100MHz / f₂</p>
                        <p>2 = 100MHz / f₂</p>
                        <p>f₂ = 100MHz / 2 = <strong>50 MHz</strong></p>
                        <p>Power scales linearly with frequency (at constant voltage).</p>
                    </div>
                </div>
            </div>

            <!-- Question 8: NAND vs NOR Speed -->
            <div class="practice-question">
                <div class="question-header" onclick="toggleAnswer('q8')">
                    <span class="question-number">Question 8</span>
                    <span class="question-topic">NAND2 vs NOR2 Speed Comparison</span>
                </div>
                <div class="question-body">
                    <p>Given: Ron_NMOS = 100Ω, Ron_PMOS = 200Ω, CL = 5pF</p>
                    <p>For both 2 input NAND and 2 input NOR gates:</p>
                    <p>1. Calculate the worst case pull up and pull down resistances</p>
                    <p>2. Explain why NAND2 is faster than NOR2</p>
                </div>
                <div id="q8-answer" class="answer-reveal">
                    <div class="answer-label">Answer:</div>
                    <div class="answer-explanation">
                        <p><strong>NAND2:</strong></p>
                        <p>PDN: 2 NMOS in series → R = 100 + 100 = 200Ω</p>
                        <p>PUN: 2 PMOS in parallel → R = 200/2 = 100Ω</p>
                        <p><strong>NOR2:</strong></p>
                        <p>PDN: 2 NMOS in parallel → R = 100/2 = 50Ω</p>
                        <p>PUN: 2 PMOS in series → R = 200 + 200 = 400Ω</p>
                        <p><strong>Why NAND is faster:</strong></p>
                        <p>NAND worst case: 200Ω (series NMOS)</p>
                        <p>NOR worst case: 400Ω (series PMOS)</p>
                        <p>Since t ≈ RC, NOR has 2x longer delay due to series PMOS.</p>
                        <p>PMOS is inherently slower because holes have lower mobility than electrons.</p>
                    </div>
                </div>
            </div>

            <!-- Question 9: Synthesize CMOS Circuit -->
            <div class="practice-question">
                <div class="question-header" onclick="toggleAnswer('q9')">
                    <span class="question-number">Question 9</span>
                    <span class="question-topic">Synthesize CMOS Circuit</span>
                </div>
                <div class="question-body">
                    <p>Synthesize a CMOS circuit that implements the Boolean function:</p>
                    <p style="font-family: monospace; font-size: 1.2rem; text-align: center; padding: 10px;">Y = A'(B' + C'D')</p>
                    <p>Show both the PDN and PUN networks.</p>
                </div>
                <div id="q9-answer" class="answer-reveal">
                    <div class="answer-label">Answer:</div>
                    <div class="answer-explanation">
                        <p><strong>Step 1: Find Y' for PDN</strong></p>
                        <p>Y = A'(B' + C'D')</p>
                        <p>Y' = A + B(C + D) (using DeMorgan's)</p>
                        <p><strong>PDN (uses uncomplemented inputs):</strong></p>
                        <p>Y' = A + B(C + D)</p>
                        <p>Structure: Qa in parallel with (Qb in series with (Qc parallel Qd))</p>
                        <p>Notation: Qa // (Qb - (Qc // Qd))</p>
                        <p><strong>PUN (uses complemented inputs):</strong></p>
                        <p>Y = A'(B' + C'D')</p>
                        <p>Structure: Qa in series with (Qb in parallel with (Qc series Qd))</p>
                        <p>Notation: Qa - (Qb // (Qc - Qd))</p>
                        <p><strong>Note:</strong> PUN and PDN are duals. Series↔Parallel swap.</p>
                    </div>
                </div>
            </div>

            <!-- Question 10: Non-Ideal Inverter -->
            <div class="practice-question">
                <div class="question-header" onclick="toggleAnswer('q10')">
                    <span class="question-number">Question 10</span>
                    <span class="question-topic">Non Ideal Switch Model</span>
                </div>
                <div class="question-body">
                    <p>A CMOS inverter has:</p>
                    <p>NMOS: Ron = 100Ω, Roff = 1MΩ</p>
                    <p>PMOS: Ron = 200Ω, Roff = 1MΩ</p>
                    <p>VDD = 3V</p>
                    <p>Calculate Vout and DC power consumption for:</p>
                    <p>(a) Vin = VDD = 3V</p>
                    <p>(b) Vin = GND = 0V</p>
                </div>
                <div id="q10-answer" class="answer-reveal">
                    <div class="answer-label">Answer:</div>
                    <div class="answer-explanation">
                        <p><strong>(a) Vin = 3V (HIGH):</strong></p>
                        <p>NMOS ON (100Ω), PMOS OFF (1MΩ)</p>
                        <p>Vout = VDD × (Rn)/(Rp + Rn) = 3 × 100/(1000000 + 100)</p>
                        <p>Vout ≈ 0.0003V ≈ 0.3mV (essentially 0)</p>
                        <p>Pdc = VDD²/(Rp + Rn) = 9/(1000100) ≈ 9µW</p>
                        <p><strong>(b) Vin = 0V (LOW):</strong></p>
                        <p>NMOS OFF (1MΩ), PMOS ON (200Ω)</p>
                        <p>Vout = VDD × (Rn)/(Rp + Rn) = 3 × 1000000/(200 + 1000000)</p>
                        <p>Vout ≈ 2.9994V ≈ 3V (essentially VDD)</p>
                        <p>Pdc = VDD²/(Rp + Rn) = 9/(1000200) ≈ 9µW</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Power Section -->
        <div id="power" class="section">
            <h2>CMOS Power Consumption</h2>

            <p>One of the biggest advantages of CMOS is its <span class="highlight">extremely low static power consumption</span>. Power is primarily consumed during switching.</p>

            <div class="circuit-container">
                <div class="circuit-box">
                    <div class="circuit-title">Static Power (DC)</div>

                    <p>When a CMOS circuit is not switching, one of PUN or PDN is always OFF. The OFF transistor has very high resistance (megaohms), so almost no current flows from VDD to GND.</p>

                    <div class="formula-box">
                        Pstatic ≈ 0
                    </div>

                    <p style="font-size: 0.9rem; color: #888; text-align: center;">This is why CMOS is ideal for battery powered devices</p>
                </div>

                <div class="circuit-box">
                    <div class="circuit-title">Dynamic Power (AC)</div>

                    <p>Power is consumed when the circuit switches states. This happens because the load capacitor must be charged and discharged.</p>

                    <div class="formula-box">
                        Pdynamic = f × C × VDD²
                    </div>

                    <p style="margin-top: 10px;"><span class="highlight">f</span> = Switching frequency (Hz)</p>
                    <p><span class="highlight">C</span> = Load capacitance (F)</p>
                    <p><span class="highlight">VDD</span> = Supply voltage (V)</p>
                </div>
            </div>

            <div class="key-points">
                <h4>Power Reduction Strategies</h4>
                <ul>
                    <li>Reduce VDD (most effective since power scales with VDD²)</li>
                    <li>Reduce switching frequency (clock gating)</li>
                    <li>Reduce capacitance (smaller transistors, shorter wires)</li>
                    <li>Avoid unnecessary switching (power gating)</li>
                </ul>
            </div>

            <div class="circuit-box" style="margin-top: 20px;">
                <div class="circuit-title">Example Calculation</div>
                <p>A CMOS circuit dissipates 800mW at VDD = 5V and f = 100MHz.</p>
                <p>To reduce power to 400mW at the same voltage, what frequency is needed?</p>

                <div class="formula-box">
                    P₁/P₂ = f₁/f₂
                </div>
                <div class="formula-box">
                    800/400 = 100/f₂
                </div>
                <div class="formula-box">
                    f₂ = 50 MHz
                </div>
            </div>
        </div>
    </div>

    <script>
        // Section Navigation
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
        }

        // NMOS Transistor Demo
        function setNMOS(value) {
            const gateState = document.getElementById('nmos-gate-state');
            const switchState = document.getElementById('nmos-switch-state');
            const switchLine = document.getElementById('nmos-switch');

            if (value === 1) {
                gateState.textContent = '1';
                gateState.className = 'state-value high';
                switchState.textContent = 'ON';
                switchState.className = 'state-value high';
                switchLine.setAttribute('stroke', '#00ff88');
                switchLine.setAttribute('stroke-dasharray', '0');
            } else {
                gateState.textContent = '0';
                gateState.className = 'state-value low';
                switchState.textContent = 'OFF';
                switchState.className = 'state-value low';
                switchLine.setAttribute('stroke', '#666');
                switchLine.setAttribute('stroke-dasharray', '5,5');
            }
        }

        // PMOS Transistor Demo
        function setPMOS(value) {
            const gateState = document.getElementById('pmos-gate-state');
            const switchState = document.getElementById('pmos-switch-state');
            const switchLine = document.getElementById('pmos-switch');

            if (value === 0) {
                gateState.textContent = '0';
                gateState.className = 'state-value low';
                switchState.textContent = 'ON';
                switchState.className = 'state-value high';
                switchLine.setAttribute('stroke', '#00ff88');
                switchLine.setAttribute('stroke-dasharray', '0');
            } else {
                gateState.textContent = '1';
                gateState.className = 'state-value high';
                switchState.textContent = 'OFF';
                switchState.className = 'state-value low';
                switchLine.setAttribute('stroke', '#666');
                switchLine.setAttribute('stroke-dasharray', '5,5');
            }
        }

        // Inverter Demo
        function setInverter(input) {
            const inputState = document.getElementById('inv-input-state');
            const pmosState = document.getElementById('inv-pmos-state');
            const nmosState = document.getElementById('inv-nmos-state');
            const outputState = document.getElementById('inv-output-state');
            const pmos = document.getElementById('inv-pmos');
            const nmos = document.getElementById('inv-nmos');
            const outputWire = document.getElementById('inv-output-wire');
            const inputIndicator = document.getElementById('inv-input-indicator');
            const outputIndicator = document.getElementById('inv-output-indicator');

            document.querySelectorAll('#inverter .truth-table tr').forEach(r => r.classList.remove('active-row'));

            if (input === 0) {
                inputState.textContent = '0';
                inputState.className = 'state-value low';
                pmosState.textContent = 'ON';
                pmosState.className = 'state-value high';
                nmosState.textContent = 'OFF';
                nmosState.className = 'state-value low';
                outputState.textContent = '1';
                outputState.className = 'state-value high';

                pmos.setAttribute('fill', 'rgba(123,44,191,0.7)');
                pmos.style.boxShadow = '0 0 20px #7b2cbf';
                nmos.setAttribute('fill', 'rgba(0,212,255,0.3)');
                outputWire.setAttribute('stroke', '#ff6b6b');
                inputIndicator.setAttribute('fill', '#333');
                outputIndicator.setAttribute('fill', '#00ff88');

                document.getElementById('inv-row-0').classList.add('active-row');
            } else {
                inputState.textContent = '1';
                inputState.className = 'state-value high';
                pmosState.textContent = 'OFF';
                pmosState.className = 'state-value low';
                nmosState.textContent = 'ON';
                nmosState.className = 'state-value high';
                outputState.textContent = '0';
                outputState.className = 'state-value low';

                pmos.setAttribute('fill', 'rgba(123,44,191,0.3)');
                nmos.setAttribute('fill', 'rgba(0,212,255,0.7)');
                outputWire.setAttribute('stroke', '#4ecdc4');
                inputIndicator.setAttribute('fill', '#00ff88');
                outputIndicator.setAttribute('fill', '#333');

                document.getElementById('inv-row-1').classList.add('active-row');
            }
        }

        // NAND Gate Demo
        let nandA = 0, nandB = 0;

        function toggleNAND(input) {
            if (input === 'a') {
                nandA = 1 - nandA;
                const btn = document.getElementById('nand-btn-a');
                btn.textContent = `A = ${nandA}`;
                btn.className = nandA ? 'control-btn input-high' : 'control-btn input-low';
                document.getElementById('nand-input-a').setAttribute('fill', nandA ? '#00ff88' : '#333');
            } else {
                nandB = 1 - nandB;
                const btn = document.getElementById('nand-btn-b');
                btn.textContent = `B = ${nandB}`;
                btn.className = nandB ? 'control-btn input-high' : 'control-btn input-low';
                document.getElementById('nand-input-b').setAttribute('fill', nandB ? '#00ff88' : '#333');
            }
            updateNAND();
        }

        function updateNAND() {
            const output = !(nandA && nandB);
            const outputState = document.getElementById('nand-output-state');
            const outputIndicator = document.getElementById('nand-output-indicator');

            outputState.textContent = output ? '1' : '0';
            outputState.className = output ? 'state-value high' : 'state-value low';
            outputIndicator.setAttribute('fill', output ? '#00ff88' : '#333');

            // Update transistor highlights
            document.getElementById('nand-pmos-a').setAttribute('fill', nandA ? 'rgba(123,44,191,0.3)' : 'rgba(123,44,191,0.7)');
            document.getElementById('nand-pmos-b').setAttribute('fill', nandB ? 'rgba(123,44,191,0.3)' : 'rgba(123,44,191,0.7)');
            document.getElementById('nand-nmos-a').setAttribute('fill', nandA ? 'rgba(0,212,255,0.7)' : 'rgba(0,212,255,0.3)');
            document.getElementById('nand-nmos-b').setAttribute('fill', nandB ? 'rgba(0,212,255,0.7)' : 'rgba(0,212,255,0.3)');

            // Update truth table highlighting
            document.querySelectorAll('#nand .truth-table tr').forEach(r => r.classList.remove('active-row'));
            document.getElementById(`nand-row-${nandA}${nandB}`).classList.add('active-row');
        }

        // NOR Gate Demo
        let norA = 0, norB = 0;

        function toggleNOR(input) {
            if (input === 'a') {
                norA = 1 - norA;
                const btn = document.getElementById('nor-btn-a');
                btn.textContent = `A = ${norA}`;
                btn.className = norA ? 'control-btn input-high' : 'control-btn input-low';
                document.getElementById('nor-input-a').setAttribute('fill', norA ? '#00ff88' : '#333');
            } else {
                norB = 1 - norB;
                const btn = document.getElementById('nor-btn-b');
                btn.textContent = `B = ${norB}`;
                btn.className = norB ? 'control-btn input-high' : 'control-btn input-low';
                document.getElementById('nor-input-b').setAttribute('fill', norB ? '#00ff88' : '#333');
            }
            updateNOR();
        }

        function updateNOR() {
            const output = !(norA || norB);
            const outputState = document.getElementById('nor-output-state');
            const outputIndicator = document.getElementById('nor-output-indicator');

            outputState.textContent = output ? '1' : '0';
            outputState.className = output ? 'state-value high' : 'state-value low';
            outputIndicator.setAttribute('fill', output ? '#00ff88' : '#333');

            // Update transistor highlights
            document.getElementById('nor-pmos-a').setAttribute('fill', norA ? 'rgba(123,44,191,0.3)' : 'rgba(123,44,191,0.7)');
            document.getElementById('nor-pmos-b').setAttribute('fill', norB ? 'rgba(123,44,191,0.3)' : 'rgba(123,44,191,0.7)');
            document.getElementById('nor-nmos-a').setAttribute('fill', norA ? 'rgba(0,212,255,0.7)' : 'rgba(0,212,255,0.3)');
            document.getElementById('nor-nmos-b').setAttribute('fill', norB ? 'rgba(0,212,255,0.7)' : 'rgba(0,212,255,0.3)');

            // Update truth table highlighting
            document.querySelectorAll('#nor .truth-table tr').forEach(r => r.classList.remove('active-row'));
            document.getElementById(`nor-row-${norA}${norB}`).classList.add('active-row');
        }

        // Initialize with default states
        setNMOS(0);
        setPMOS(1);
        setInverter(0);

        // Toggle practice question answers
        function toggleAnswer(questionId) {
            const answer = document.getElementById(questionId + '-answer');
            answer.classList.toggle('show');
        }
    </script>
</body>
</html>
